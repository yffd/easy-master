<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.yffd.easy.app.permission.dao.impl.PmsUserDaoImpl">

	<!-- ##############################   基础sql开始   ############################## -->
	
	<resultMap id="resutlId" type="org.yffd.easy.app.permission.entity.PmsUser">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="version" property="version" jdbcType="INTEGER" />
		<result column="status" property="status" jdbcType="VARCHAR" />
		<result column="creater" property="creater" jdbcType="VARCHAR" />
		<result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
		<result column="editor" property="editor" jdbcType="VARCHAR" />
		<result column="edit_time" property="editTime" jdbcType="TIMESTAMP" />
		<result column="remark" property="remark" jdbcType="VARCHAR" />
		
		<result column="user_name" property="userName" jdbcType="VARCHAR" />
		<result column="user_code" property="userCode" jdbcType="VARCHAR" />
		<result column="user_pwd" property="userPwd" jdbcType="VARCHAR" />
		<result column="real_name" property="realName" jdbcType="VARCHAR"  />
		<result column="mobile_no" property="mobileNo" jdbcType="VARCHAR"  />
	</resultMap>

	<sql id="pms_user_table"> pms_user </sql>
	<sql id="pms_user_columns"> id, version, status, creater, create_time, editor, edit_time, remark, 
	user_name, user_code, user_pwd, real_name, mobile_no </sql>
	<!-- 动态组装复合查询条件 -->
	<sql id="pms_user_where">
		<!-- Equal query -->
		<if test="userName != null and userName != ''"> and user_name = #{userName} </if>
		<if test="userCode != null and userCode != ''"> and user_code = #{userCode} </if>
		<if test="userPwd != null and userPwd != ''"> and user_pwd = #{userPwd} </if>
		<if test="realName != null and realName != ''"> and real_name = #{realName} </if>
		<if test="mobileNo != null and mobileNo != ''"> and mobile_no = #{mobileNo} </if>
	</sql>
	
	<!-- 分页查询 -->
	<select id="selectPage" parameterType="java.util.Map" resultMap="resutlId">
		select
		<include refid="pms_user_columns"/>
		from
		<include refid="pms_user_table" />
		<where>
			<include refid="pms_user_where" />
		</where>
		order by create_time desc limit #{startRowNum}, #{numPerPage}
	</select>

	<select id="selectCountBy" parameterType="java.util.Map" resultType="long">
		select count(1) from
		<include refid="pms_user_table" />
		<where>
			<include refid="pms_user_where" />
		</where>
	</select>
	
	<select id="selectByPK" parameterType="java.lang.String" resultMap="resutlId">
		select
		<include refid="pms_user_columns"/>
		from
		<include refid="pms_user_table" />
		where id = #{_parameter}
	</select>
	
	<!-- selectListBy、selectBy、selectAll -->
	<select id="selectListBy" parameterType="java.util.Map" resultMap="resutlId">
		select
		<include refid="pms_user_columns"/>
		from
		<include refid="pms_user_table" />
		<where>
			<include refid="pms_user_where" />
		</where>
	</select>
	
	<insert id="insert" parameterType="org.yffd.easy.app.permission.entity.PmsUser" keyProperty="id" useGeneratedKeys="true">
		insert into
		<include refid="pms_user_table" />
		(version,status,creater,create_time, editor, edit_time, remark, 
		user_name, user_code, user_pwd, real_name, mobile_no)
		values
		(0, #{status}, #{creater}, #{createTime}, #{editor}, #{editTime}, #{remark}, 
		#{userName}, #{userCode}, #{userPwd}, #{realName}, #{mobileNo})
	</insert>
		
	<insert id="insertBatch" parameterType="java.util.List">
		insert into 
		<include refid="pms_user_table" />
		(version,status,creater,create_time, editor, edit_time, remark, 
		user_name, user_code, user_pwd, real_name, mobile_no)
		values
		<foreach collection="list" item="item" index="index" separator="," >  
		(0, #{item.status}, #{item.creater}, #{item.createTime}, #{item.editor}, #{item.editTime}, #{item.remark}, 
		#{item.userName}, #{item.userCode}, #{item.userPwd}, #{item.realName}, #{item.mobileNo})
    	</foreach>
	</insert> 

	<update id="updateByPK" parameterType="org.yffd.easy.app.permission.entity.PmsUser">
		update <include refid="pms_user_table" />
		<set>
			version = #{version} + 1,
			creater = #{creater, jdbcType=VARCHAR},
			create_time = #{createTime, jdbcType=TIMESTAMP},
			editor = #{editor, jdbcType=VARCHAR},
			edit_time = #{editTime, jdbcType=TIMESTAMP},
			remark = #{remark, jdbcType=VARCHAR},
			user_name = #{userName, jdbcType=VARCHAR},
			user_code = #{userCode, jdbcType=VARCHAR},
			user_pwd = #{userPwd, jdbcType=VARCHAR},
			real_name = #{realName, jdbcType=VARCHAR},
			mobile_no = #{mobileNo, jdbcType=VARCHAR},
		</set>
		<where>
			id = #{id} and version = #{version}
		</where>
	</update>
	
	<update id="updateBatch" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="" close="" separator=";">
			update <include refid="pms_user_table" />
            <set>
				version = #{item.version} + 1,
				<if test="item.creater != null and item.creater !='' ">creater = #{item.creater,jdbcType=VARCHAR},</if>
				<if test="item.createTime != null">create_time = #{item.createTime, jdbcType=TIMESTAMP},</if>
				<if test="item.editor != null and item.editor !='' ">editor = #{item.editor, jdbcType=VARCHAR},</if>
				<if test="item.editTime != null">edit_time = #{item.editTime, jdbcType=TIMESTAMP},</if>
				<if test="item.remark != null and item.remark !='' ">remark = #{item.remark, jdbcType=VARCHAR},</if>
				<if test="item.userName != null and item.userName !='' ">user_name = #{item.userName, jdbcType=VARCHAR},</if>
				<if test="item.userCode != null and item.userCode !='' ">user_code = #{item.userCode, jdbcType=VARCHAR},</if>
				<if test="item.userPwd != null and item.userPwd !='' ">user_pwd = #{item.userPwd, jdbcType=VARCHAR},</if>
				<if test="item.realName != null and item.realName !='' ">real_name = #{item.realName, jdbcType=VARCHAR},</if>
				<if test="item.mobileNo != null and item.mobileNo !='' ">mobile_no = #{item.mobileNo, jdbcType=VARCHAR},</if>
			</set>
			where id=#{item.id} and version = #{item.version}
        </foreach>
	</update>
	
	<delete id="deleteByPK" parameterType="java.lang.String">
		delete from
		<include refid="pms_user_table" />
		where id = #{_parameter}
	</delete>
	
	<delete id="deleteBy" parameterType="java.util.Map">
		delete from
		<include refid="pms_user_table" />
		<where>
			<include refid="pms_user_where" />
		</where>
	</delete>
	
	<delete id="deleteBatch" parameterType="java.util.List">
		delete from
		<include refid="pms_user_table" />
		where id in
		<foreach item="item" index="index" collection="list" open="(" separator="," close=")">#{item.id}</foreach>
	</delete>
	
	<!-- ##############################   基础sql结束    ############################## -->
	
</mapper>