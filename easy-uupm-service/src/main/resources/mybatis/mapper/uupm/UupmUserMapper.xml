<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yffd.easy.uupm.dao.UupmUserDao">
	<!-- ######################################################################### -->
	<!-- ##############################   基础sql开始    ############################## -->
	<!-- ######################################################################### -->
	
	<resultMap id="resutlId" type="com.yffd.easy.uupm.api.model.UupmUserModel">
		<id column="ID" property="id" />
		<result column="VERSION" property="version" />
		<result column="DEL_FLAG" property="delFlag" />
		<result column="CREATE_BY" property="createBy" />
		<result column="CREATE_TIME" property="createTime" />
		<result column="UPDATE_BY" property="updateBy" />
		<result column="UPDATE_TIME" property="updateTime" />
		<result column="LOGIN_ID" property="loginId" />
		<result column="LOGIN_PWD" property="loginPwd" />
		<result column="LOGIN_STATUS" property="loginStatus" />
		<result column="TENANT_CODE" property="tenantCode" />
		<result column="USER_CODE" property="userCode" />
		<result column="USER_NAME" property="userName" />
		<result column="USER_TYPE" property="userType" />
	</resultMap>

	<!-- 表名 -->
	<sql id="table_name"> uupm_user </sql>

	<!-- 列名 -->
	<sql id="table_columns">
		t.VERSION, t.DEL_FLAG, t.CREATE_BY, t.CREATE_TIME, t.UPDATE_BY, t.UPDATE_TIME, t.ID, t.LOGIN_ID, t.LOGIN_PWD, t.LOGIN_STATUS, t.TENANT_CODE, t.USER_CODE, t.USER_NAME, t.USER_TYPE
	</sql>

	<!-- 分页条件 -->
	<sql id="conditions_limit"><if test="pageParam != null"> limit #{pageParam.pageStartRow}, #{pageParam.pageLimit} </if></sql>

	<!-- 排序条件 -->
	<sql id="conditions_orderby"> ORDER BY t.CREATE_TIME desc </sql>

	<!-- 动态组装复合查询条件 -->
	<sql id="conditions_where">
		<!-- Equal query -->
		<if test="version != null "> and t.VERSION = #{version} </if>
		<if test="delFlag != null and delFlag != ''"> and t.DEL_FLAG = #{delFlag} </if>
		<if test="createBy != null and createBy != ''"> and t.CREATE_BY = #{createBy} </if>
		<if test="createTime != null "><![CDATA[ and t.CREATE_TIME = #{createTime}]]> </if>
		<if test="updateBy != null and updateBy != ''"> and t.UPDATE_BY = #{updateBy} </if>
		<if test="updateTime != null "><![CDATA[ and t.UPDATE_TIME = #{updateTime}]]> </if>
		<if test="id != null and id != ''"> and t.ID = #{id} </if>
		<if test="loginId != null and loginId != ''"> and t.LOGIN_ID = #{loginId} </if>
		<if test="loginPwd != null and loginPwd != ''"> and t.LOGIN_PWD = #{loginPwd} </if>
		<if test="loginStatus != null and loginStatus != ''"> and t.LOGIN_STATUS = #{loginStatus} </if>
		<if test="tenantCode != null and tenantCode != ''"> and t.TENANT_CODE = #{tenantCode} </if>
		<if test="userCode != null and userCode != ''"> and t.USER_CODE = #{userCode} </if>
		<if test="userType != null and userType != ''"> and t.USER_TYPE = #{userType} </if>
		<!-- Like query -->
		<if test="userName != null and userName != ''"> and t.USER_NAME like CONCAT(CONCAT('%', #{userName}), '%') </if>
		<!-- 非model属性 -->
		<!-- in条件处理拼写，要求List集合中的值能转换成key-value形式，例如map、自定义model对象等 -->
		<if test="idList != null and idList.size()>0">
		and ID in <foreach item="item" index="index" collection="idList" open="(" separator="," close=")">#{item.id}</foreach>
		</if>
		<if test="loginIdList != null and loginIdList.size()>0">
		and LOGIN_ID in <foreach item="item" index="index" collection="loginIdList" open="(" separator="," close=")">#{item.loginId}</foreach>
		</if>
		<if test="loginPwdList != null and loginPwdList.size()>0">
		and LOGIN_PWD in <foreach item="item" index="index" collection="loginPwdList" open="(" separator="," close=")">#{item.loginPwd}</foreach>
		</if>
		<if test="loginStatusList != null and loginStatusList.size()>0">
		and LOGIN_STATUS in <foreach item="item" index="index" collection="loginStatusList" open="(" separator="," close=")">#{item.loginStatus}</foreach>
		</if>
		<if test="tenantCodeList != null and tenantCodeList.size()>0">
		and TENANT_CODE in <foreach item="item" index="index" collection="tenantCodeList" open="(" separator="," close=")">#{item.tenantCode}</foreach>
		</if>
		<if test="userCodeList != null and userCodeList.size()>0">
		and USER_CODE in <foreach item="item" index="index" collection="userCodeList" open="(" separator="," close=")">#{item.userCode}</foreach>
		</if>
		<if test="userNameList != null and userNameList.size()>0">
		and USER_NAME in <foreach item="item" index="index" collection="userNameList" open="(" separator="," close=")">#{item.userName}</foreach>
		</if>
		<if test="userTypeList != null and userTypeList.size()>0">
		and USER_TYPE in <foreach item="item" index="index" collection="userTypeList" open="(" separator="," close=")">#{item.userType}</foreach>
		</if>
		
		<if test="sUpdateTime != null and sUpdateTime != ''"><![CDATA[ and t.UPDATE_TIME = #{sUpdateTime}]]> </if>
	</sql>

<!-- 	分页查询 -->
<!-- 	<select id="selectRangeBy" parameterType="java.util.Map" resultMap="resutlId"> -->
<!-- 		select <include refid="table_columns" /> -->
<!-- 		from <include refid="table_name"/>  as t  -->
<!-- 		<where> -->
<!-- 			<include refid="conditions_where" /> -->
<!-- 		</where> -->
<!-- 		<include refid="conditions_orderby" /> -->
<!-- 		<include refid="conditions_limit" /> -->
<!-- 	</select> -->

	<!-- 条件查询 -->
	<select id="selectListBy" parameterType="java.util.Map" resultMap="resutlId">
		select <include refid="table_columns" />
		from <include refid="table_name"/>  as t 
		<where>
			<include refid="conditions_where" />
		</where>
		<include refid="conditions_orderby" />
		<include refid="conditions_limit" />
	</select>

	<!-- 统计查询 -->
	<select id="selectCountBy" parameterType="java.util.Map" resultType="long">
		select count(1) from 
		<include refid="table_name"/>  as t 
		<where>
			<include refid="conditions_where" />
		</where>
	</select>

	<!-- in条件查询 -->
<!-- 	<select id="selectListByIds" parameterType="java.util.List" resultMap="resutlId"> -->
<!-- 		select <include refid="table_columns" />  -->
<!-- 		from <include refid="table_name"/>  as t  -->
<!-- 		<where> -->
<!-- 			t.ID in  -->
<!-- 			<foreach item="item" index="index" collection="list" open="(" separator="," close=")">#{item}</foreach> -->
<!-- 		</where> -->
<!-- 	</select> -->

	<!-- 单条查询 -->
	<select id="selectOneBy" parameterType="java.util.Map" resultMap="resutlId">
		select <include refid="table_columns" /> 
		from <include refid="table_name"/>  as t 
		<where>
			<include refid="conditions_where" />
		</where>
	</select>

	<!-- 单条插入 -->
	<insert id="insertOne" parameterType="java.util.Map" keyProperty="id" useGeneratedKeys="true">
		insert into
		<include refid="table_name" />
		(VERSION, DEL_FLAG, CREATE_BY, CREATE_TIME, UPDATE_BY, UPDATE_TIME, LOGIN_ID, LOGIN_PWD, LOGIN_STATUS, TENANT_CODE, USER_CODE, USER_NAME, USER_TYPE)
		values
		(#{version}, #{delFlag}, #{createBy}, #{createTime}, #{updateBy}, #{updateTime}, #{loginId}, #{loginPwd}, #{loginStatus}, #{tenantCode}, #{userCode}, #{userName}, #{userType})
	</insert>

	<!-- 批量插入 -->
	<insert id="insertBatch" parameterType="java.util.Map" keyProperty="id" useGeneratedKeys="true">
		insert into <include refid="table_name" />
		(VERSION, DEL_FLAG, CREATE_BY, CREATE_TIME, UPDATE_BY, UPDATE_TIME, LOGIN_ID, LOGIN_PWD, LOGIN_STATUS, TENANT_CODE, USER_CODE, USER_NAME, USER_TYPE)
		values
		<foreach collection="list" item="item" index="index" separator=",">
		(#{item.version},
		#{item.delFlag},
		#{item.createBy},
		#{item.createTime},
		#{item.updateBy},
		#{item.updateTime},
		#{item.loginId},
		#{item.loginPwd},
		#{item.loginStatus},
		#{item.tenantCode},
		#{item.userCode},
		#{item.userName},
		#{item.userType})
		</foreach>
	</insert>

	<!-- 更新 -->
	<update id="updateBy" parameterType="java.util.Map">
		update <include refid="table_name" />
		<set>
		VERSION = VERSION + 1, 
		<if test="delFlag != null and delFlag != ''"> DEL_FLAG = #{delFlag},  </if>
		<if test="createBy != null and createBy != ''"> CREATE_BY = #{createBy},  </if>
		<if test="updateBy != null and updateBy != ''"> UPDATE_BY = #{updateBy},  </if>
		<if test="updateTime != null "> UPDATE_TIME = #{updateTime},  </if>
		<if test="loginId != null and loginId != ''"> LOGIN_ID = #{loginId},  </if>
		<if test="loginPwd != null and loginPwd != ''"> LOGIN_PWD = #{loginPwd},  </if>
		<if test="loginStatus != null and loginStatus != ''"> LOGIN_STATUS = #{loginStatus},  </if>
		<if test="tenantCode != null and tenantCode != ''"> TENANT_CODE = #{tenantCode},  </if>
		<if test="userCode != null and userCode != ''"> USER_CODE = #{userCode},  </if>
		<if test="userName != null and userName != ''"> USER_NAME = #{userName},  </if>
		<if test="userType != null and userType != ''"> USER_TYPE = #{userType},  </if>
		</set>
		<where>
			ID = #{id}
			<if test="version != null "> and VERSION = #{version} </if>
		</where>
	</update>

	<!-- 批量更新 -->
	<update id="updateBatch" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" separator=";">
		update <include refid="table_name" />
		<set>
		VERSION = VERSION + 1, 
		<if test="item.delFlag != null and item.delFlag != ''"> DEL_FLAG = #{item.delFlag},  </if>
		<if test="item.createBy != null and item.createBy != ''"> CREATE_BY = #{item.createBy},  </if>
		<if test="item.createTime != null "> CREATE_TIME = #{item.createTime},  </if>
		<if test="item.updateBy != null and item.updateBy != ''"> UPDATE_BY = #{item.updateBy},  </if>
		<if test="item.updateTime != null "> UPDATE_TIME = #{item.updateTime},  </if>
		<if test="item.loginId != null and item.loginId != ''"> LOGIN_ID = #{item.loginId},  </if>
		<if test="item.loginPwd != null and item.loginPwd != ''"> LOGIN_PWD = #{item.loginPwd},  </if>
		<if test="item.loginStatus != null and item.loginStatus != ''"> LOGIN_STATUS = #{item.loginStatus},  </if>
		<if test="item.tenantCode != null and item.tenantCode != ''"> TENANT_CODE = #{item.tenantCode},  </if>
		<if test="item.userCode != null and item.userCode != ''"> USER_CODE = #{item.userCode},  </if>
		<if test="item.userName != null and item.userName != ''"> USER_NAME = #{item.userName},  </if>
		<if test="item.userType != null and item.userType != ''"> USER_TYPE = #{item.userType},  </if>
		</set>
		<where>
			ID = #{item.id}
			<if test="item.version != null "> and VERSION = #{item.version} </if>
		</where>
		</foreach>
	</update>

	<!-- 删除 -->
	<delete id="deleteBy" parameterType="java.util.Map">
		delete from <include refid="table_name" />
		<where>
		<if test="version != null "> and VERSION = #{version} </if>
		<if test="delFlag != null and delFlag != ''"> and DEL_FLAG = #{delFlag} </if>
		<if test="createBy != null and createBy != ''"> and CREATE_BY = #{createBy} </if>
		<if test="createTime != null "><![CDATA[ and CREATE_TIME = #{createTime}]]> </if>
		<if test="updateBy != null and updateBy != ''"> and UPDATE_BY = #{updateBy} </if>
		<if test="updateTime != null "><![CDATA[ and UPDATE_TIME = #{updateTime}]]> </if>
		<if test="id != null and id != ''"> and ID = #{id} </if>
		<if test="loginId != null and loginId != ''"> and LOGIN_ID = #{loginId} </if>
		<if test="loginPwd != null and loginPwd != ''"> and LOGIN_PWD = #{loginPwd} </if>
		<if test="loginStatus != null and loginStatus != ''"> and LOGIN_STATUS = #{loginStatus} </if>
		<if test="tenantCode != null and tenantCode != ''"> and TENANT_CODE = #{tenantCode} </if>
		<if test="userCode != null and userCode != ''"> and USER_CODE = #{userCode} </if>
		<if test="userName != null and userName != ''"> and USER_NAME = #{userName} </if>
		<if test="userType != null and userType != ''"> and USER_TYPE = #{userType} </if>
		
		<!-- 防止没有参数传递，导致全部删除 -->
		or 1=2
		</where>
	</delete>

	<!-- 删除：可以带in条件 -->
	<delete id="deleteWithInBy" parameterType="java.util.Map">
		delete from <include refid="table_name" />
		<where>
		<if test="version != null "> and VERSION = #{version} </if>
		<if test="delFlag != null and delFlag != ''"> and DEL_FLAG = #{delFlag} </if>
		<if test="createBy != null and createBy != ''"> and CREATE_BY = #{createBy} </if>
		<if test="createTime != null "><![CDATA[ and CREATE_TIME = #{createTime}]]> </if>
		<if test="updateBy != null and updateBy != ''"> and UPDATE_BY = #{updateBy} </if>
		<if test="updateTime != null "><![CDATA[ and UPDATE_TIME = #{updateTime}]]> </if>
		<if test="id != null and id != ''"> and ID = #{id} </if>
		<if test="loginId != null and loginId != ''"> and LOGIN_ID = #{loginId} </if>
		<if test="loginPwd != null and loginPwd != ''"> and LOGIN_PWD = #{loginPwd} </if>
		<if test="loginStatus != null and loginStatus != ''"> and LOGIN_STATUS = #{loginStatus} </if>
		<if test="tenantCode != null and tenantCode != ''"> and TENANT_CODE = #{tenantCode} </if>
		<if test="userCode != null and userCode != ''"> and USER_CODE = #{userCode} </if>
		<if test="userName != null and userName != ''"> and USER_NAME = #{userName} </if>
		<if test="userType != null and userType != ''"> and USER_TYPE = #{userType} </if>
		
		<!-- 批量处理拼写，要求List集合的值能转换成map形式 -->
		<if test="idList != null and idList.size()>0">
		and ID in <foreach item="item" index="index" collection="idList" open="(" separator="," close=")">#{item.id}</foreach>
		</if>
		<if test="loginIdList != null and loginIdList.size()>0">
		and LOGIN_ID in <foreach item="item" index="index" collection="loginIdList" open="(" separator="," close=")">#{item.loginId}</foreach>
		</if>
		<if test="loginPwdList != null and loginPwdList.size()>0">
		and LOGIN_PWD in <foreach item="item" index="index" collection="loginPwdList" open="(" separator="," close=")">#{item.loginPwd}</foreach>
		</if>
		<if test="loginStatusList != null and loginStatusList.size()>0">
		and LOGIN_STATUS in <foreach item="item" index="index" collection="loginStatusList" open="(" separator="," close=")">#{item.loginStatus}</foreach>
		</if>
		<if test="tenantCodeList != null and tenantCodeList.size()>0">
		and TENANT_CODE in <foreach item="item" index="index" collection="tenantCodeList" open="(" separator="," close=")">#{item.tenantCode}</foreach>
		</if>
		<if test="userCodeList != null and userCodeList.size()>0">
		and USER_CODE in <foreach item="item" index="index" collection="userCodeList" open="(" separator="," close=")">#{item.userCode}</foreach>
		</if>
		<if test="userNameList != null and userNameList.size()>0">
		and USER_NAME in <foreach item="item" index="index" collection="userNameList" open="(" separator="," close=")">#{item.userName}</foreach>
		</if>
		<if test="userTypeList != null and userTypeList.size()>0">
		and USER_TYPE in <foreach item="item" index="index" collection="userTypeList" open="(" separator="," close=")">#{item.userType}</foreach>
		</if>
		
		<!-- 防止没有参数传递，导致全部删除 -->
		or 1=2
		</where>
	</delete>

	<!-- ######################################################################### -->
	<!-- ##############################   基础sql结束    ############################## -->
	<!-- ######################################################################### -->

</mapper>
